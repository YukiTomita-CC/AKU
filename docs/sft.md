# Memo
SFTはデータセットをグループ化してカリキュラム学習にする

雑談会話に特化するとなると、やはり会話の多様性が欲しい。それとSteerLMのAttribute、会話のターン数もある程度のばらつきが必要だと思う。
- ジャンル的なグループ分け
- t-SNEなどで意味的な分布
- Attributeの組み合わせ分布(5段階の2要素だから全部で25ペア)
- 会話のターン数の分布
- ターンごとのテキスト長の分布

以上の観点から多角的に偏りが生じていないか適宜確認する。

パラメータ数にも限界があるから、なるべく専門的な知識は詰め込みたくない。常識とかに留める。

早い段階からデータセット作成のための協力を仰ぐのはありかもしれない。でも、がっつりデータセット作成に携わってもらうのは厳しいから、「○○について会話を始めてください。」みたいな感じの一問一答を10問、15問くらい作ってそれをGoogle Formsとかで回答してもらう感じになるかな。

## SFTデータセット作成の進め方
- データセットのサイズ数は3,000件を目標にする
- 初めは完全な手作業で、contextと会話、attributeを作っていく
  - 10ターンの10会話セットとして、contextは10個とも異なるもの、会話は主要なトピック、attributeは以下の5種類とする
    - (2, 2): Userはちょいちょい会う人で、Akuの機嫌は良くも悪くもない
    - (4, 4): Userはパートナーで、Akuの機嫌はとても良い
    - (0, 0): Userは知らない人で、Akuの機嫌はとても悪い
    - (4, 0): Userはパートナーで、Akuの機嫌はとても悪い
    - (0, 4): Userは知らない人で、Akuの機嫌はとても良い
- 最初の500件が溜まったら、baselineの2epochかinc_batchの1epochに対してSFTする
- もし、SFTの結果が良好であれば、Akuのレスポンスを手作業で作成する前にモデルに生成させるようにする
- 以降、データセットの偏りをチェックしながら、データセットを拡充させていく

コードで書いてみるとこんな感じ
```python
model_supportable = False
for i in range(3000):
    if i < 100:
        context, conversation, attribute = create_data_by_human(use_model=False)
        data.append({
            'context': context,
            'conversation': conversation,
            'attribute': attribute
        })

    elif i >= 100 and not model_supportable: # 100件かもしれないし、500件かもしれない
        sft_model.train(data)
        if is_good_sft_model_response():
            model_supportable = True

    else:
        context, attribute = create_data_by_human(use_model=True)
        conversation = model_response(context)
        conversation = check_human(conversation)
        
        data.append({
            'context': context,
            'conversation': conversation,
            'attribute': attribute
        })
    
    check_dataset(visualize(data))
```

## 雑談会話とは？
主要なLLMの認識を確かめてみる
### Claude 3.5 Sonnet
**1. 個人的な話題**
  * 家族や友人について
  * 趣味や興味
  * 最近の出来事や経験

**2. 社会的な話題**
  - ニュースや時事問題
  - 政治や経済
  - 文化や芸術

**3. 環境に関する話題**
  - 天気
  - 季節の変化
  - 地域の出来事

**4. 仕事や学業に関する話題**
  - 職場や学校での出来事
  - キャリアや将来の計画
  - 学習や自己啓発

**5. 娯楽に関する話題**
  - テレビ番組や映画
  - 音楽やスポーツ
  - ゲームや本

**6. 健康やライフスタイルに関する話題**
  - 食事や運動
  - ストレス管理
  - 生活習慣

**7. 技術や科学に関する話題**
  - 新しいガジェット
  - 科学的発見
  - テクノロジーの進歩

**8. 思い出話や回顧**
  - 懐かしい経験
  - 共有した思い出
  - 過去の出来事

### Gemini 1.5 Pro Experimental 0827
**1. 社会的なつながりを確認・強化する雑談**
  * **挨拶・天候など**：その場の雰囲気を和ませ、会話のきっかけを作るためのもの。「おはようございます」「今日は暑いですね」など。
  * **近況報告**：「最近どう？」「仕事忙しい？」など、互いの状況を共有し、気遣いを示すもの。
  * **共通の話題**：ニュース、スポーツ、芸能など、共通の関心事について語り合うことで共感を深めるもの。
  * **相手の状況・持ち物に関するコメント**：「新しい髪型素敵ですね」「そのバッグいいですね」など、相手に興味を示し、褒めることで親近感を高めるもの。

**2. 情報交換を目的とする雑談**
  * **地域情報**：「この辺りで美味しいお店知らない？」「おすすめの病院はありますか？」など、生活に役立つ情報を交換するもの。
  * **専門知識・経験の共有**：「パソコンに詳しいんですね」「旅行によく行くんですか？」など、相手の得意分野について話を聞き、知識や経験を得るもの。
  * **噂話・ゴシップ**：共通の知り合いや、社会的な出来事について、情報交換や意見交換をするもの。（倫理的に問題がない範囲で）

**3. 気分転換・娯楽を目的とする雑談**
  * **冗談・ユーモア**：面白い話やジョークを交わすことで、場を和ませ、楽しい時間を共有するもの。
  * **趣味の話**：「最近どんな映画見た？」「ゲームは何やってるの？」など、共通の趣味について語り合い、盛り上がりを楽しむもの。
  * **思い出話**：「昔はよく〇〇に行ったよね」「学生時代はこんなことがあった」など、過去の楽しかった出来事を共有し、ノスタルジックな気分に浸るもの。
  * **愚痴・不満**：溜まっているストレスを発散するために、ネガティブな感情を共有するもの。（ただし、度が過ぎないように注意が必要）

**4. その他**
  * **沈黙を埋める雑談**：気まずい沈黙を避けるため、特に深い意味のない話を続けるもの。
  * **時間調整のための雑談**：待ち合わせ時間までの時間つぶしなど、時間を有効活用するために軽く会話を続けるもの。

### GPT-4o
**1. 天気・季節に関する話題**
  - **例:** 「今日は暑いね」「明日は雨らしいよ」
  - 誰でも簡単に参加できる話題で、挨拶代わりとしてよく使われます。

**2. 趣味・娯楽に関する話題**
  - **例:** 「最近どんな映画を観た？」「趣味は何？」
  - お互いの共通点を探しやすく、仲を深めるきっかけになりやすい話題です。

**3. 仕事・学校に関する話題**
  - **例:** 「最近のプロジェクトはどう？」「学校は楽しい？」
  - その場の関係性に応じて、具体的な内容から軽い愚痴まで幅広い話ができます。

**4. 食べ物・飲み物に関する話題**
  - **例:** 「美味しいお店知ってる？」「今日は何食べた？」
  - レストランやカフェの話題は、気軽な会話としてよく利用されます。

**5. ニュース・時事に関する話題**
  - **例:** 「最近あのニュース見た？」「新しい法律が施行されたみたいだね」
  - 時事ネタはその時期によって内容が変わりやすく、意見交換が活発になることも。

**6. 旅行・お出かけに関する話題**
  - **例:** 「どこか旅行に行った？」「おすすめの観光地ある？」
  - 過去の体験をシェアしたり、行きたい場所の話題で盛り上がります。

**7. 健康・美容に関する話題**
  - **例:** 「最近ジムに通い始めたんだ」「肌の調子がいいね」
  - 健康や美容は、特に親しい間柄での話題としてもよく出てきます。

**8. 家族や友人に関する話題**
  - **例:** 「兄弟は元気？」「友達と会う予定があるんだ」
  - 親しい相手との間でプライベートな話題として展開されやすい。

**9. 趣味のテクニカルな話題**
  - **例:** 「新しいカメラの機能がすごいよ」「パソコンのスペックが上がった」
  - 専門的な趣味を持つ人同士が技術的な話題で交流する場合があります。

**10. 軽い悩みや愚痴**
  - **例:** 「最近忙しくて大変だよ」「電車がいつも遅れるんだよね」
  - ストレスを発散しつつ、共感を得るための話題です。

**11. 人間関係や感情に関する話題**
  - **例:** 「最近あの人とあまり話してない」「ちょっと落ち込んでる」
  - 感情や人間関係についての会話は、親密な関係で特に話されやすいです。
